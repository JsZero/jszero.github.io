{"pages":[{"title":"å…³äº","text":"ä¸€ä¸ªèœé¸Ÿç å†œçš„ç©ºé—´ğŸ” æ²¿é€”çš„é£æ™¯ ğŸ• å®¶é‡Œçš„å°æŸ´çŠ¬â€œå·é¥¼â€ ğŸ¶ å¬è¿‡çš„æ¼”å”±ä¼š ğŸ² å“å°è¿‡çš„ç¾é£Ÿ","link":"/about/index.html"}],"posts":[{"title":"Akkaä½¿ç”¨æ•™ç¨‹","text":"Akka æ˜¯ä¸€ä¸ªç”¨ Scala ç¼–å†™çš„åº“ï¼Œç”¨äºåœ¨ JVM å¹³å°ä¸Šç®€åŒ–ç¼–å†™å…·æœ‰å¯å®¹é”™çš„ã€é«˜å¯ä¼¸ç¼©æ€§çš„ Java å’Œ Scala çš„ Actor æ¨¡å‹åº”ç”¨ï¼Œå…¶åŒæ—¶æä¾›äº†Java å’Œ Scala çš„å¼€å‘æ¥å£ã€‚Akka å…è®¸æˆ‘ä»¬ä¸“æ³¨äºæ»¡è¶³ä¸šåŠ¡éœ€æ±‚ï¼Œè€Œä¸æ˜¯ç¼–å†™åˆçº§ä»£ç ã€‚åœ¨ Akka ä¸­ï¼ŒActor ä¹‹é—´é€šä¿¡çš„å”¯ä¸€æœºåˆ¶å°±æ˜¯æ¶ˆæ¯ä¼ é€’ã€‚Akka å¯¹ Actor æ¨¡å‹çš„ä½¿ç”¨æä¾›äº†ä¸€ä¸ªæŠ½è±¡çº§åˆ«ï¼Œä½¿å¾—ç¼–å†™æ­£ç¡®çš„å¹¶å‘ã€å¹¶è¡Œå’Œåˆ†å¸ƒå¼ç³»ç»Ÿæ›´åŠ å®¹æ˜“ã€‚Actor æ¨¡å‹è´¯ç©¿äº†æ•´ä¸ª Akka åº“ï¼Œä¸ºæˆ‘ä»¬æä¾›äº†ä¸€è‡´çš„ç†è§£å’Œä½¿ç”¨å®ƒä»¬çš„æ–¹æ³• ActorsIntroduction to Actorså¾…è¡¥å……","link":"/2022/07/02/Akka%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/"},{"title":"DolphinScheduleræºç é˜…è¯»æ—¥è®°ï¼ˆä¸‰ï¼‰é€šä¿¡æœºåˆ¶","text":"æ¦‚è¿°DolphinSchedulerçš„é€šä¿¡æœºåˆ¶æ˜¯é€šè¿‡Nettyæ¥å®ç°çš„ï¼Œåœ¨Nettyä¸ŠåŠ åšäº†ä¸€äº›å°è£…å’ŒæŠ½è±¡ Nettyç®€ä»‹åŠŸèƒ½ä»‹ç»Netty æ˜¯ä¸€ä¸ªåŸºäº Java çš„é«˜æ€§èƒ½ç½‘ç»œåº”ç”¨æ¡†æ¶ï¼Œå¹¿æ³›ç”¨äºå¼€å‘é«˜å¹¶å‘ã€ä½å»¶è¿Ÿçš„ç½‘ç»œæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ã€‚å®ƒæä¾›äº†ä¸€ç»„ä¸°å¯Œçš„ API å’Œå·¥å…·ï¼Œç®€åŒ–äº†ç½‘ç»œé€šä¿¡çš„å¼€å‘è¿‡ç¨‹ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤§é‡å¹¶å‘è¿æ¥å’Œæ•°æ®æµæ—¶ã€‚ ä¸ºå„ç§ä¼ è¾“ç±»å‹ï¼ˆé˜»å¡å’Œéé˜»å¡socketï¼‰æä¾›ç»Ÿä¸€API åŸºäºçµæ´»ä¸”å¯æ‰©å±•çš„äº‹ä»¶æ¨¡å‹ï¼Œå…è®¸æ˜ç¡®åˆ†ç¦»å…³æ³¨ç‚¹ é«˜åº¦å¯å®šåˆ¶çš„çº¿ç¨‹æ¨¡å‹â€”â€”å•çº¿ç¨‹ã€ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹æ± ï¼ˆå¦‚ SEDAï¼‰ çœŸæ­£çš„æ— è¿æ¥æ•°æ®æŠ¥socketæ”¯æŒï¼ˆè‡ª3.1ç‰ˆèµ·ï¼‰ åŸºç¡€æ¦‚å¿µ table th:first-of-type {width: 20%;} table th:nth-of-type(2) {width: 80%;} æ¦‚å¿µ å«ä¹‰ Channel Channel æ˜¯ Netty ä¸­ç”¨äºç½‘ç»œé€šä¿¡çš„åŸºæœ¬æŠ½è±¡ï¼Œè¡¨ç¤ºä¸€ä¸ªåˆ°ç½‘ç»œå¥—æ¥å­—ï¼ˆSocketï¼‰çš„è¿æ¥ã€‚å®ƒç±»ä¼¼äº Java NIO çš„ Channelï¼Œä½†æä¾›äº†æ›´å¤šçš„é«˜çº§åŠŸèƒ½ã€‚Channel å¯ä»¥æ˜¯ TCPã€UDP æˆ–è€…æ–‡ä»¶ä¼ è¾“ç­‰ä¸åŒç±»å‹çš„è¿æ¥ EventLoop EventLoop æ˜¯ Netty ä¸­çš„äº‹ä»¶å¤„ç†æ ¸å¿ƒã€‚æ¯ä¸ª EventLoop éƒ½ä¸ä¸€ä¸ªæˆ–å¤šä¸ª Channel å…³è”ï¼Œè´Ÿè´£å¤„ç†è¿™äº› Channel ä¸Šçš„æ‰€æœ‰ I/O æ“ä½œï¼ŒåŒ…æ‹¬è¯»å†™äº‹ä»¶çš„è°ƒåº¦ã€‚EventLoop ä½¿ç”¨å•çº¿ç¨‹æ¨¡å¼ï¼Œå¯ä»¥æœ‰æ•ˆåœ°é¿å…çº¿ç¨‹é—´ç«äº‰ ChannelHandler ChannelHandler æ˜¯ç”¨äºå¤„ç† Channel ä¸Šçš„ I/O äº‹ä»¶çš„ç»„ä»¶ã€‚Netty é€šè¿‡ ChannelHandler å®ç°äº†çµæ´»çš„äº‹ä»¶å¤„ç†æœºåˆ¶ã€‚å¸¸è§çš„ ChannelHandler ç±»å‹åŒ…æ‹¬ ChannelInboundHandler å’Œ ChannelOutboundHandlerï¼Œåˆ†åˆ«ç”¨äºå¤„ç†å…¥ç«™å’Œå‡ºç«™æ•°æ® Pipeline Pipeline æ˜¯ Netty ä¸­çš„ä¸€ä¸ªé‡è¦æ¦‚å¿µï¼Œå®ƒæ˜¯ ChannelHandler çš„æœ‰åºé“¾è¡¨ã€‚æ‰€æœ‰ä¸ Channel ç›¸å…³çš„äº‹ä»¶ï¼ˆå¦‚è¯»ã€å†™ã€è¿æ¥ç­‰ï¼‰éƒ½ä¼šæ²¿ç€ Pipeline ä¾æ¬¡ä¼ é€’ã€‚å¼€å‘è€…å¯ä»¥æ ¹æ®éœ€è¦åœ¨ Pipeline ä¸­æ’å…¥ä¸åŒçš„ ChannelHandler æ¥å®ç°å®šåˆ¶çš„é€»è¾‘ Bootstrap Bootstrap æ˜¯ç”¨äºé…ç½®å’Œå¯åŠ¨å®¢æˆ·ç«¯æˆ–æœåŠ¡å™¨ç«¯ Channel çš„ç±»ã€‚å®ƒç®€åŒ–äº†ç½‘ç»œåº”ç”¨ç¨‹åºçš„å¯åŠ¨è¿‡ç¨‹ï¼Œå¼€å‘è€…å¯ä»¥é€šè¿‡ Bootstrap è®¾ç½®ç›¸å…³å‚æ•°ï¼Œå¦‚çº¿ç¨‹æ± ã€äº‹ä»¶å¤„ç†å™¨ç­‰ ByteBuf ByteBuf æ˜¯ Netty æä¾›çš„ç”¨äºé«˜æ•ˆå¤„ç†å­—èŠ‚æ•°æ®çš„ç¼“å†²åŒºã€‚ä¸ Java NIO ä¸­çš„ ByteBuffer ä¸åŒï¼ŒByteBuf æä¾›äº†æ›´å¤šçš„æ“ä½œæ–¹æ³•ï¼Œå¹¶ä¸”æ”¯æŒåŠ¨æ€æ‰©å±•ã€å¼•ç”¨è®¡æ•°ç­‰ç‰¹æ€§ï¼Œæå¤§åœ°æé«˜äº†å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„æ•ˆç‡ Future&amp;Promise Future å’Œ Promise æ˜¯ Netty ä¸­çš„å¼‚æ­¥ç¼–ç¨‹æ¨¡å‹ï¼Œç”¨äºè¡¨ç¤ºå¼‚æ­¥æ“ä½œçš„ç»“æœã€‚Future è¡¨ç¤ºä¸€ä¸ªå°šæœªå®Œæˆçš„æ“ä½œç»“æœï¼Œè€Œ Promise åˆ™æ˜¯å¯ä»¥æ‰‹åŠ¨è®¾ç½®ç»“æœçš„ Futureã€‚è¿™ä¸¤ä¸ªæ¥å£å¸®åŠ©å¼€å‘è€…å¤„ç†å¼‚æ­¥ä»»åŠ¡çš„å›è°ƒé€»è¾‘ Transport Transport æ˜¯ Netty ä¸­çš„åº•å±‚æŠ½è±¡ï¼Œè´Ÿè´£å®ç°å…·ä½“çš„ç½‘ç»œåè®®ï¼ˆå¦‚ TCPã€UDPï¼‰çš„ä¼ è¾“æœºåˆ¶ã€‚ä¸åŒçš„ Transport å®ç°å¯ä»¥æœ‰ä¸åŒçš„ I/O æ¨¡å‹ï¼ˆå¦‚ NIOã€Epoll ç­‰ï¼‰ï¼Œé€‚ç”¨äºä¸åŒçš„æ“ä½œç³»ç»Ÿå’Œæ€§èƒ½éœ€æ±‚ é€šä¿¡æœºåˆ¶å®ç°å…³é”®ç±»åœ¨MasterServerã€WorkerServerä¸­åˆ†åˆ«éƒ½å­˜åœ¨ä¸€ä¸ªRpcServerå’ŒRpcClientï¼Œç”¨äºä½œä¸ºRPCçš„æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ åºåˆ—åŒ–ä¸ååºåˆ—åŒ–Messgaeçš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ– æ¶ˆæ¯çš„å¤„ç†å¦‚ä½•æ˜ å°„åˆ°å¯¹åº”çš„Processorå¤„ç†ï¼ˆå€¼å¾—å€Ÿé‰´ï¼‰","link":"/2024/08/23/DolphinScheduler%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E6%97%A5%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89%E9%80%9A%E4%BF%A1%E6%9C%BA%E5%88%B6/"},{"title":"DolphinScheduleræºç é˜…è¯»æ—¥è®°ï¼ˆä¸€ï¼‰å¼€å‘ç¯å¢ƒæ­å»º","text":"ç³»ç»Ÿç¯å¢ƒ ç¯å¢ƒ ç‰ˆæœ¬ ç³»ç»Ÿ macOS 12.2.1/m1 pro JRE Zulu 8.62.0.19-CA-macos-aarch64 Maven 3.8.6 Node 18.4.0 Pnpm 7.3.0 Zookeeper 3.8.4 MySQL 8.0.28 DolphinScheduler 3.2.0 æ­å»ºé¡¹ç›®å¼€å‘ç¯å¢ƒé¡¹ç›®ä¸‹è½½ä»githubä¸‹è½½æºç ä»dolphinscheduleræºç ä»“åº“ä¸‹è½½æºç  12git clone https://github.com/apache/dolphinschedulergit checkout 3.2.0 # åˆ‡æ¢åˆ°3.2.0åˆ†æ”¯ Zookeeperä¸‹è½½äºŒè¿›åˆ¶å¯æ‰§è¡ŒåŒ… ä¸‹è½½Zookeeper 3.8.4äºŒè¿›åˆ¶å¯æ‰§è¡ŒåŒ… åˆ›å»ºæ–‡ä»¶&amp;æ—¥å¿—ç›®å½• è§£å‹å‹ç¼©åŒ…ï¼Œåˆ›å»ºdataã€datalogç›®å½• 123cd /Users/jiashaoqi/plugin/zookeepertar -zxvf apache-zookeeper-3.8.4-bin.tar.gzmkdir data datalog ä¿®æ”¹é…ç½®æ–‡ä»¶å°†confç›®å½•ä¸‹çš„zoo_sample.cfgæ–‡ä»¶ï¼Œå¤åˆ¶ä¸€ä»½ï¼Œé‡å‘½åä¸ºzoo.cfgï¼Œä¿®æ”¹å…¶ä¸­æ•°æ®å’Œæ—¥å¿—çš„é…ç½®ï¼Œå¦‚ï¼š 123cd ./apache-zookeeper-3.8.4-bin/confcp zoo_sample.cfg zoo.cfgvi zoo.cfg æ·»åŠ ç¯å¢ƒå˜é‡12vi ~/.bash_profile # æ·»åŠ å†…å®¹å¦‚ä¸‹source ~/.bash_profile å¯åŠ¨Zookeeper1zkServer.sh start # è§åˆ°å¦‚å›¾æ‰€ç¤ºå³ä¸ºå¯åŠ¨æˆåŠŸ MySQLæ•°æ®åº“é…ç½®åˆå§‹åŒ–æ•°æ®åº“åŠè´¦å·åˆ›å»ºå®Œæ–°æ•°æ®åº“dolphinscheduleråï¼Œå°†dolphinscheduler/dolphinscheduler-dao/src/main/resources/sql/dolphinscheduler_mysql.sqlä¸‹çš„sqlæ–‡ä»¶ç›´æ¥åœ¨MySQLä¸­è¿è¡Œï¼Œå®Œæˆæ•°æ®åº“åˆå§‹åŒ– 1234567891011121314151617181920mysql&gt; create database dolphinscheduler;Query OK, 1 row affected (0.01 sec)mysql&gt; create user 'dolphin'@'localhost' identified by 'nihplod';Query OK, 0 rows affected (0.01 sec)mysql&gt; grant all privileges on dolphinscheduler.* to 'dolphin'@'localhost';Query OK, 0 rows affected (0.00 sec)mysql&gt; flush privileges;Query OK, 0 rows affected (0.00 sec)mysql&gt; use dolphinscheduler;Database changedmysql&gt; source /Users/jiashaoqi/workspace/idea/dolphinscheduler/dolphinscheduler-dao/src/main/resources/sql/dolphinscheduler_mysql.sql;Query OK, 1 row affected (0.00 sec)...Query OK, 1 row affected (0.00 sec) åç«¯Mavenä¾èµ–ä¸‹è½½é€šè¿‡ideaæ‰“å¼€é¡¹ç›®ï¼Œä¸‹è½½ä¾èµ–ï¼Œè¿™å¯èƒ½éœ€è¦ä¸€æ®µæ—¶é—´ æ³¨æ„ï¼šmavenä¸‹è½½ä¾èµ–å¯èƒ½ä¼šå‡ºç°é—®é¢˜ï¼Œå¯¹äºä¸‹è½½å‡ºé”™çš„ä¾èµ–æˆ–è€…æ’ä»¶ï¼Œå¯ä»¥åˆ°æœ¬åœ°mavenä»“åº“ç›®å½•ä¸‹åˆ é™¤å¯¹åº”çš„å­ç›®å½•é‡æ–°ä¸‹è½½ï¼Œå¦‚åœ¨ä¸‹è½½ä¾èµ–åç¼–è¯‘æ—¶å‘ç”Ÿäº†å¦‚ä¸‹å¼‚å¸¸ 1java: è¯»å–/Users/jiashaoqi/plugin/maven/apache-maven-3.8.6/repo/io/fabric8/kubernetes-model-core/5.10.2/kubernetes-model-core-5.10.2.jaræ—¶å‡ºé”™; zip file is empty æ‰€ä»¥æ‰‹åŠ¨ä¸‹è½½ä¾èµ–kubernetes-model-core 12rm -rfv /Users/jiashaoqi/plugin/maven/apache-maven-3.8.6/repo/io/fabric8/kubernetes-model-core/5.10.2mvn dependency:get -DgroupId=io.fabric8 -DartifactId=kubernetes-model-core -Dversion=5.10.2 ä¿®æ”¹æ•°æ®åº“é…ç½® å°†dolphinscheduler-bom/pom.xmlæ–‡ä»¶ä¸­mysql-connector-javaä¾èµ–çš„scopeä¿®æ”¹ä¸ºcompile å°†å¦‚ä¸‹é…ç½®æ–‡ä»¶ä¸­çš„mysqlçš„datasourceé…ç½®ä¸ºå¦‚ä¸‹å†…å®¹12345dolphinscheduler-master/src/main/resources/application.yaml:151dolphinscheduler-alert/dolphinscheduler-alert-server/src/main/resources/application.yaml:93dolphinscheduler-api/src/main/resources/application.yaml:229dolphinscheduler-standalone-server/src/main/resources/application.yaml:305dolphinscheduler-tools/src/main/resources/application.yaml:49 é…ç½®å é…ç½®å€¼ datasource.driver-class-name com.mysql.cj.jdbc.Driver datasource.url jdbc:mysql://127.0.0.1:3306/dolphinscheduler datasource.username dolphin datasource.password nihplod ä¿®æ”¹æ—¥å¿—çº§åˆ«ä¸ºä»¥ä¸‹é…ç½®å¢åŠ ä¸€è¡Œå†…å®¹ ä½¿æ—¥å¿—èƒ½åœ¨å‘½ä»¤è¡Œä¸­æ˜¾ç¤º 123dolphinscheduler-master/src/main/resources/logback-spring.xmldolphinscheduler-worker/src/main/resources/logback-spring.xmldolphinscheduler-api/src/main/resources/logback-spring.xml 12345&lt;root level=&quot;INFO&quot;&gt;+ &lt;appender-ref ref=&quot;STDOUT&quot;/&gt; &lt;appender-ref ref=&quot;APILOGFILE&quot;/&gt; &lt;appender-ref ref=&quot;SKYWALKING-LOG&quot;/&gt;&lt;/root&gt; å¯ä»¥å†åœ¨STDOUTè¿™ä¸ªappenderçš„patternä¸Šå¥—ä¸€ä¸ª%clr(...)ï¼Œè®©æ—¥å¿—åœ¨æ§åˆ¶å°ä¸Šé«˜äº®æ˜¾ç¤ºï¼Œå¦‚ 12345678910111213&lt;configuration scan=&quot;true&quot; scanPeriod=&quot;120 seconds&quot;&gt;+ &lt;include resource=&quot;org/springframework/boot/logging/logback/defaults.xml&quot; /&gt; &lt;!-- ... --&gt; &lt;appender name=&quot;STDOUT&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt; &lt;encoder&gt; &lt;pattern&gt;+ %clr([%level] %date{yyyy-MM-dd HH:mm:ss.SSS Z} %logger{96}:[%line] - [WorkflowInstance-%X{workflowInstanceId:-0}][TaskInstance-%X{taskInstanceId:-0}] - %msg%n) &lt;/pattern&gt; &lt;charset&gt;UTF-8&lt;/charset&gt; &lt;/encoder&gt; &lt;/appender&gt; &lt;!-- ... --&gt;&lt;/configuration&gt; ç¼–è¯‘æºä»£ç  è¿è¡Œåç«¯æœåŠ¡å‚è€ƒDolphinScheduler æ™®é€šå¼€å‘æ¨¡å¼éœ€è¦å¯åŠ¨ä¸‰ä¸ªæœåŠ¡ï¼ŒåŒ…æ‹¬ MasterServerï¼ŒWorkerServerï¼ŒApiApplicationServer MasterServerï¼šåœ¨ Intellij IDEA ä¸­æ‰§è¡Œ org.apache.dolphinscheduler.server.master.MasterServer ä¸­çš„ main æ–¹æ³•ï¼Œå¹¶é…ç½® VM Options -Dlogging.config=classpath:logback-spring.xml -Ddruid.mysql.usePingMethod=false -Dspring.profiles.active=mysql WorkerServerï¼šåœ¨ Intellij IDEA ä¸­æ‰§è¡Œ org.apache.dolphinscheduler.server.worker.WorkerServer ä¸­çš„ main æ–¹æ³•ï¼Œå¹¶é…ç½® VM Options -Dlogging.config=classpath:logback-spring.xml -Ddruid.mysql.usePingMethod=false -Dspring.profiles.active=mysql ApiApplicationServerï¼šåœ¨ Intellij IDEA ä¸­æ‰§è¡Œ org.apache.dolphinscheduler.api.ApiApplicationServer ä¸­çš„ main æ–¹æ³•ï¼Œå¹¶é…ç½® VM Options -Dlogging.config=classpath:logback-spring.xml -Dspring.profiles.active=api,mysqlã€‚å¯åŠ¨å®Œæˆå¯ä»¥æµè§ˆ Open API æ–‡æ¡£ï¼Œåœ°å€ä¸º http://localhost:12345/dolphinscheduler/swagger-ui/index.html å‰ç«¯å®‰è£…ä¾èµ–ï¼Œè¿è¡Œå‰ç«¯æœåŠ¡123cd dolphinscheduler-uipnpm installpnpm run dev æˆªæ­¢ç›®å‰ï¼Œå‰åç«¯å·²æˆåŠŸè¿è¡Œèµ·æ¥ï¼Œæµè§ˆå™¨è®¿é—® http://localhost:5173 ï¼Œå¹¶ä½¿ç”¨é»˜è®¤è´¦æˆ·å¯†ç  admin/dolphinscheduler123 å³å¯å®Œæˆç™»å½• å®Œæˆç¯å¢ƒæ­å»ºæ­å»ºæˆåŠŸæ•ˆæœ","link":"/2024/07/27/Dolphinscheduler%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E6%97%A5%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"},{"title":"DolphinScheduleræºç é˜…è¯»æ—¥è®°ï¼ˆäºŒï¼‰MasterServerå·¥ä½œæµè°ƒåº¦æºç è§£æ","text":"ç³»ç»Ÿæ¶æ„ MasterServer MasterServeré‡‡ç”¨åˆ†å¸ƒå¼æ— ä¸­å¿ƒè®¾è®¡ç†å¿µï¼ŒMasterServerä¸»è¦è´Ÿè´£ DAG ä»»åŠ¡åˆ‡åˆ†ã€ä»»åŠ¡æäº¤ç›‘æ§ï¼Œå¹¶åŒæ—¶ç›‘å¬å…¶å®ƒMasterServerå’ŒWorkerServerçš„å¥åº·çŠ¶æ€ã€‚ MasterServeræœåŠ¡å¯åŠ¨æ—¶å‘Zookeeperæ³¨å†Œä¸´æ—¶èŠ‚ç‚¹ï¼Œé€šè¿‡ç›‘å¬Zookeeperä¸´æ—¶èŠ‚ç‚¹å˜åŒ–æ¥è¿›è¡Œå®¹é”™å¤„ç†ã€‚ MasterServeråŸºäºnettyæä¾›ç›‘å¬æœåŠ¡ã€‚ è¯¥æœåŠ¡å†…ä¸»è¦åŒ…å«: DistributedQuartz: åˆ†å¸ƒå¼è°ƒåº¦ç»„ä»¶ï¼Œä¸»è¦è´Ÿè´£å®šæ—¶ä»»åŠ¡çš„å¯åœæ“ä½œï¼Œå½“quartzè°ƒèµ·ä»»åŠ¡åï¼ŒMasterå†…éƒ¨ä¼šæœ‰çº¿ç¨‹æ± å…·ä½“è´Ÿè´£å¤„ç†ä»»åŠ¡çš„åç»­æ“ä½œï¼› MasterSchedulerService: æ˜¯ä¸€ä¸ªæ‰«æçº¿ç¨‹ï¼Œå®šæ—¶æ‰«ææ•°æ®åº“ä¸­çš„t_ds_commandè¡¨ï¼Œæ ¹æ®ä¸åŒçš„å‘½ä»¤ç±»å‹è¿›è¡Œä¸åŒçš„ä¸šåŠ¡æ“ä½œï¼› WorkflowExecuteRunnable: ä¸»è¦æ˜¯è´Ÿè´£DAGä»»åŠ¡åˆ‡åˆ†ã€ä»»åŠ¡æäº¤ç›‘æ§ã€å„ç§ä¸åŒäº‹ä»¶ç±»å‹çš„é€»è¾‘å¤„ç†ï¼› TaskExecuteRunnable: ä¸»è¦è´Ÿè´£ä»»åŠ¡çš„å¤„ç†å’ŒæŒä¹…åŒ–ï¼Œå¹¶ç”Ÿæˆä»»åŠ¡äº‹ä»¶æäº¤åˆ°å·¥ä½œæµçš„äº‹ä»¶é˜Ÿåˆ—ï¼› EventExecuteService: ä¸»è¦è´Ÿè´£å·¥ä½œæµå®ä¾‹çš„äº‹ä»¶é˜Ÿåˆ—çš„è½®è¯¢ï¼› StateWheelExecuteThread: ä¸»è¦è´Ÿè´£å·¥ä½œæµå’Œä»»åŠ¡è¶…æ—¶ã€ä»»åŠ¡é‡è¯•ã€ä»»åŠ¡ä¾èµ–çš„è½®è¯¢ï¼Œå¹¶ç”Ÿæˆå¯¹åº”çš„å·¥ä½œæµæˆ–ä»»åŠ¡äº‹ä»¶æäº¤åˆ°å·¥ä½œæµçš„äº‹ä»¶é˜Ÿåˆ—ï¼› FailoverExecuteThread: ä¸»è¦è´Ÿè´£Masterå®¹é”™å’ŒWorkerå®¹é”™çš„ç›¸å…³é€»è¾‘ï¼› æ ¸å¿ƒæ¦‚å¿µ table th:first-of-type {width: 25%;} table th:nth-of-type(2) {width: 75%;} æ¦‚å¿µ å«ä¹‰ Process Definition å·¥ä½œæµå®šä¹‰ Process Instance å·¥ä½œæµå®ä¾‹ï¼Œå®é™…è¿è¡Œæ—¶ä¼šè¢«åŒ…è£…ä¸ºWorkflowExecuteRunnable Command äº‹ä»¶æ¶ˆæ¯ å…³é”®æµç¨‹åˆ†æ ä»¥ä¸‹æµç¨‹éƒ½åœ¨MasterServerä¸­æ‰§è¡Œï¼Œä¸å†åœ¨æ ‡é¢˜ä¸­èµ˜è¿° æ‹‰å–äº‹ä»¶MasterSchedulerBootstrapæ˜¯ç”¨äºä»MySQLä¸­æ‹‰å–äº‹ä»¶ï¼ˆCommandï¼‰çš„ä¸»è¦çº¿ç¨‹ï¼Œåœ¨MasterServerå¯åŠ¨æ—¶å¯åŠ¨ï¼Œé€šè¿‡findCommands()æ–¹æ³•æ‰¾åˆ°å¾…æ‰§è¡Œçš„äº‹ä»¶ï¼Œè¿™é‡Œçš„äº‹ä»¶ä¸ä»…é™äºå¼€å§‹æ‰§è¡Œå·¥ä½œæµï¼Œè¿˜æœ‰å…¶ä»–ç±»å‹ï¼Œå…·ä½“å‚è€ƒCommandTypeçš„å®šä¹‰ï¼Œå¦‚ä¸‹ è€Œæ‹‰å–äº‹ä»¶æµç¨‹ä¸­ï¼Œå¦‚ä¸‹ é‡‡ç”¨æ— ä¸­å¿ƒèŠ‚ç‚¹è®¾è®¡ï¼Œæ‰€ä»¥æ¯ä¸ªèŠ‚ç‚¹é€šè¿‡å–æ¨¡çš„æ–¹å¼è·å–å½“å‰èŠ‚ç‚¹åº”è¯¥å¤„ç†çš„äº‹ä»¶ã€‚èŠ‚ç‚¹æ€»æ•°å’Œå½“å‰èŠ‚ç‚¹çš„åºå·æ˜¯å¦‚ä½•ç”Ÿæˆçš„å‘¢ï¼Ÿä»æ³¨å†Œä¸­å¿ƒï¼ˆZK/ETCD/JDBCï¼‰è·å–æ‰€æœ‰èŠ‚ç‚¹åˆ—è¡¨ï¼Œåœ¨æœ¬åœ°ç”Ÿæˆåºå·ï¼Œè¯¦æƒ…å‚è€ƒorg.apache.dolphinscheduler.service.queue.MasterPriorityQueue.ServerComparator å¤„ç†äº‹ä»¶ï¼Œåˆ›å»ºå·¥ä½œæµå¤„ç†äº‹ä»¶ï¼Œåˆ›å»ºå·¥ä½œæµåœ¨ï¼Œå¦‚ä¸‹ è€Œåˆ›å»ºå·¥ä½œæµå…·ä½“åˆ†ä¸ºå¦‚ä¸‹å‡ ä¸ªé˜¶æ®µï¼ŒProcessDefinition -&gt; ProcessInstance (WorkflowInstance) -&gt; WorkflowExecuteContext -&gt; WorkflowExecuteRunnableï¼Œäº§ç”ŸWorkflowExecuteRunnableå®ä¾‹å³ä¸ºæœ€ç»ˆéœ€è¦è°ƒåº¦çš„å·¥ä½œæµ 1234567891011121314// ProcessDefinition -&gt; ProcessInstance(WorkflowInstance)org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteContextFactory#createWorkflowExecuteRunnableContext:56org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteContextFactory#createWorkflowInstance:81org.apache.dolphinscheduler.service.process.ProcessServiceImpl#handleCommand:317org.apache.dolphinscheduler.service.process.ProcessServiceImpl#constructProcessInstance:768org.apache.dolphinscheduler.service.process.ProcessServiceImpl#generateNewProcessInstance:586// ProcessInstance(WorkflowInstance) -&gt; WorkflowExecuteContextorg.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnableFactory#createWorkflowExecuteRunnable:79org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteContextFactory#createWorkflowExecuteRunnableContext:67// WorkflowExecuteContext -&gt; WorkflowExecuteRunnableorg.apache.dolphinscheduler.server.master.runner.MasterSchedulerBootstrap#run:137org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnableFactory#createWorkflowExecuteRunnable:80 å·¥ä½œæµè¢«åˆ›å»ºå‡ºæ¥ä¹‹åä¼šç”Ÿæˆä¸€ä¸ªå·¥ä½œæµäº‹ä»¶WorkflowEventï¼Œæ”¾åœ¨å†…å­˜çš„é˜»å¡é˜Ÿåˆ—workflowEventQueueå½“ä¸­ è°ƒåº¦å·¥ä½œæµMasterSchedulerBootstrapçº¿ç¨‹å¯åŠ¨åï¼Œè¿˜ä¼šå†å¯åŠ¨ä¸€ä¸ªWorkflowEventLooperå·¥ä½œæµäº‹ä»¶å¤„ç†çº¿ç¨‹ï¼Œç”¨äºæ¶ˆè´¹ä¸Šä¸€æ­¥æ”¾å…¥å†…å­˜çš„é˜»å¡é˜Ÿåˆ—workflowEventQueueå½“ä¸­çš„å·¥ä½œæµäº‹ä»¶WorkflowEvent WorkflowEventLooperçº¿ç¨‹ä¼šä½¿ç”¨WorkflowEventHandlerå¤„ç†å·¥ä½œæµäº‹ä»¶ WorkflowEventHandlerä¼šå°†é€šè¿‡è°ƒç”¨WorkflowExecuteRunnableå·¥ä½œæµçš„call()æ–¹æ³•ï¼Œå°†å·¥ä½œæµçš„å¯åŠ¨å¼‚æ­¥æäº¤åˆ°WorkflowExecuteThreadPoolçº¿ç¨‹æ± ä¸­æ‰§è¡Œ æœ€ç»ˆè°ƒç”¨å·¥ä½œæµçš„submitPostNode()æ–¹æ³•ï¼Œå¼€å§‹æ‰§è¡Œå·¥ä½œæµçš„èŠ‚ç‚¹ è§£æå·¥ä½œæµèŠ‚ç‚¹è·å–å¾…æäº¤çš„TaskNodeåˆ—è¡¨submitTaskNodeListï¼Œå¹¶ç”Ÿæˆå¯¹åº”çš„TaskInstanceå®ä¾‹TODO è§£æè¿‡ç¨‹æ¯”æƒ³è±¡çš„å¤æ‚ï¼Œéœ€è¦è¯¦è§£åˆ†æä¸‹ å°†ä»»åŠ¡æ·»åŠ åˆ°å†…å­˜ä¸­çš„standbyä¼˜å…ˆçº§é˜Ÿåˆ—ï¼ˆå †ï¼‰readyToSubmitTaskQueueä¸­ï¼Œå¹¶åœ¨å¼€å§‹æäº¤ä»»åŠ¡ ä¹‹ååˆ†å‘æ­¥éª¤æ¯”è¾ƒå¤æ‚ï¼Œå…·ä½“æ‹†è§£å¦‚ä¸‹ 1234567891011121314// å¼€å§‹æäº¤ä»»åŠ¡org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable#submitStandByTask:1967// ç”Ÿæˆä»»åŠ¡å®ä¾‹ï¼ˆTaskExecuteRunnableï¼‰org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable#executeTask:956// å¼€å§‹åˆ†å‘ä»»åŠ¡å®ä¾‹org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable#executeTask:993// åˆ†å‘org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable#tryToDispatchTaskInstance:1011// ä½¿ç”¨TaskDispatchOperatoråˆ†å‘org.apache.dolphinscheduler.server.master.runner.execute.DefaultTaskExecuteRunnable#dispatch:41 // å°†ä»»åŠ¡æ·»åŠ åˆ°globalTaskDispatchWaitingQueueä¸­org.apache.dolphinscheduler.server.master.runner.operator.TaskDispatchOperator#handle:34 // GlobalTaskDispatchWaitingQueueLooperçº¿ç¨‹è½®è¯¢queueï¼Œä½¿ç”¨BaseTaskDispatcheråˆ†å‘ä»»åŠ¡å®ä¾‹ç»™workerorg.apache.dolphinscheduler.server.master.runner.GlobalTaskDispatchWaitingQueueLooper#run:79 æœ€åä½¿ç”¨æ‰¾åˆ°å¯ç”¨workerèŠ‚ç‚¹ï¼Œé€šè¿‡rpcå¯åŠ¨å¾…æ‰§è¡Œä»»åŠ¡","link":"/2024/07/28/DolphinScheduler%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E6%97%A5%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89MasterServer%E5%B7%A5%E4%BD%9C%E6%B5%81%E8%B0%83%E5%BA%A6%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"},{"title":"pysparkåˆ†å¸ƒå¼è®­ç»ƒ","text":"","link":"/2022/07/03/pyspark%E5%88%86%E5%B8%83%E5%BC%8F%E8%AE%AD%E7%BB%83/"},{"title":"åˆ†å¸ƒå¼äº‹åŠ¡ä¸CAPç†è®º","text":"å¾…è¡¥å……","link":"/2022/07/24/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E4%B8%8ECAP%E7%90%86%E8%AE%BA/"},{"title":"åˆ›å»ºç¬¬ä¸€ä¸ªAkkaåº”ç”¨","text":"å…³äºæœ¬æ–‡ ç‰ˆæœ¬ï¼š2.6ä¹‹åçš„ç‰ˆæœ¬ä¸ºæ”¶è´¹ç‰ˆæœ¬ï¼Œ2.6ç‰ˆæœ¬çš„scalaç‰ˆä½¿ç”¨æ–‡æ¡£è§v2.6ä½¿ç”¨æ–‡æ¡£ï¼Œflinkåœ¨ç”¨çš„ä¹Ÿæ˜¯è¿™ä¸ªç‰ˆæœ¬ apiç±»å‹ï¼šclassicæ¯”è¾ƒçµæ´»ï¼Œè¯•ç”¨ä¸€ä¸‹classicç‰ˆæœ¬çš„api æ„å»ºåº”ç”¨Demoé…ç½®å¦‚ä¸‹çš„pomæ–‡ä»¶ pom.xml >folded1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;tech.bravoqq&lt;/groupId&gt; &lt;artifactId&gt;demo-akka&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;properties&gt; &lt;maven.compiler.source&gt;8&lt;/maven.compiler.source&gt; &lt;maven.compiler.target&gt;8&lt;/maven.compiler.target&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;scala.version&gt;2.12.19&lt;/scala.version&gt; &lt;scala.base.version&gt;2.12&lt;/scala.base.version&gt; &lt;akka.version&gt;2.6.21&lt;/akka.version&gt; &lt;/properties&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;com.typesafe.akka&lt;/groupId&gt; &lt;artifactId&gt;akka-actor_${scala.base.version}&lt;/artifactId&gt; &lt;version&gt;${akka.version}&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;build&gt; &lt;sourceDirectory&gt;src/main/scala&lt;/sourceDirectory&gt; &lt;testSourceDirectory&gt;src/test/scala&lt;/testSourceDirectory&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;net.alchim31.maven&lt;/groupId&gt; &lt;artifactId&gt;scala-maven-plugin&lt;/artifactId&gt; &lt;version&gt;4.9.2&lt;/version&gt; &lt;executions&gt; &lt;execution&gt; &lt;goals&gt; &lt;goal&gt;compile&lt;/goal&gt; &lt;goal&gt;testCompile&lt;/goal&gt; &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;configuration&gt; &lt;scalaVersion&gt;${scala.version}&lt;/scalaVersion&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt;&lt;/project&gt; å®˜æ–¹demoç»™åˆ°çš„æ˜¯ä¸€ä¸ªping-pongçš„ç³»ç»Ÿï¼Œå¦‚ä¸‹ï¼Œ Application.scala12345678910111213141516171819202122232425262728293031323334353637383940414243444546import akka.actor.{Actor, ActorRef, ActorSystem, PoisonPill, Props}import language.postfixOpsimport scala.concurrent.duration._case object Pingcase object Pongclass Pinger extends Actor { var countDown = 100 def receive = { case Pong =&gt; println(s&quot;${self.path} received pong, count down $countDown&quot;) if (countDown &gt; 0) { countDown -= 1 sender() ! Ping } else { sender() ! PoisonPill self ! PoisonPill } }}class Ponger(pinger: ActorRef) extends Actor { def receive = { case Ping =&gt; println(s&quot;${self.path} received ping&quot;) pinger ! Pong }}object Application extends App { val system = ActorSystem(&quot;pingpong&quot;) val pinger = system.actorOf(Props[Pinger](), &quot;pinger&quot;) val ponger = system.actorOf(Props(classOf[Ponger], pinger), &quot;ponger&quot;) import system.dispatcher system.scheduler.scheduleOnce(500 millis) { ponger ! Ping }}","link":"/2024/08/07/%E5%88%9B%E5%BB%BA%E7%AC%AC%E4%B8%80%E4%B8%AAAkka%E5%BA%94%E7%94%A8/"},{"title":"Flinkæºç ç¼–è¯‘","text":"å‰è¨€å­¦ä¹ ä¸€ä¸‹Flinkçš„æ‰§è¡ŒåŸç†ï¼Œéœ€è¦åœ¨æœ¬åœ°ç¼–è¯‘æºç å¥½debugè¿è¡Œã€‚ ç¼–è¯‘ç¯å¢ƒ ç¯å¢ƒ ç‰ˆæœ¬ ç³»ç»Ÿ m1 pro macbook pro 14 JRE Zulu 8.62.0.19-CA-macos-aarch64 Flink release-1.12.7-rc1 ç¼–è¯‘è¿‡ç¨‹1mvn clean package -DskipTests -Dhadoop.version=2.7.1 å‚è€ƒä¸‹Building Apache Flink from Source ç¼–è¯‘è¿‡ç¨‹ä¸­äº§ç”Ÿå¦‚ä¸‹å¼‚å¸¸å¹¶è§£å†³ æŠ¥é”™ï¼šå®‰è£…nodeå’Œnpmå¤±è´¥1[ERROR] Failed to execute goal com.github.eirslett:frontend-maven-plugin:1.6:install-node-and-npm (install node and npm) on project flink-runtime-web_2.11: Could not download Node.js: Could not download https://nodejs.org/dist/v10.9.0/node-v10.9.0-darwin-arm64.tar.gz: nodejs.org:443 failed to respond -&gt; [Help 1] è§£å†³æ–¹æ¡ˆï¼šå‚è€ƒeirslett/frontend-maven-plugin issue 952ï¼ŒFLINK-23230æåˆ°çš„é—®é¢˜ä¿®æ”¹flink/flink-runtime-web/pom.xmlæ–‡ä»¶ä¸­frontend-maven-pluginçš„ç‰ˆæœ¬ä¸º1.11.0ï¼Œå‘ç°è¿˜æ˜¯æœ‰443å¼‚å¸¸ï¼Œåæ¥å‘ç°æ˜¯mavençš„settings.xmlä¸­é…ç½®çš„proxyèµ°çš„æ˜¯sock5ï¼Œä¿®æ”¹æˆhttpä»£ç†åæ¢å¤æ­£å¸¸","link":"/2022/07/03/Flink%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91/"}],"tags":[{"name":"Akka","slug":"Akka","link":"/tags/Akka/"},{"name":"åˆ†å¸ƒå¼","slug":"åˆ†å¸ƒå¼","link":"/tags/%E5%88%86%E5%B8%83%E5%BC%8F/"},{"name":"dolphinscheduler","slug":"dolphinscheduler","link":"/tags/dolphinscheduler/"},{"name":"CAP","slug":"CAP","link":"/tags/CAP/"}],"categories":[{"name":"åˆ†å¸ƒå¼","slug":"åˆ†å¸ƒå¼","link":"/categories/%E5%88%86%E5%B8%83%E5%BC%8F/"},{"name":"è°ƒåº¦æœåŠ¡","slug":"è°ƒåº¦æœåŠ¡","link":"/categories/%E8%B0%83%E5%BA%A6%E6%9C%8D%E5%8A%A1/"}]}